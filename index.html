import requests
from bs4 import BeautifulSoup

# URL of your CAPTCHA page (for local testing, use a local server like Flask or http.server)
url = "https://example.com/captcha.html"  # Replace with actual URL

headers = {
    "User-Agent": "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"
}

def scrape_captcha(url):
    try:
        response = requests.get(url, headers=headers)
        response.raise_for_status()
        html = response.text

        print("Raw HTML Preview (first 500 characters):\n")
        print(html[:500])  # Show the first 500 characters (what a bot might see)

        soup = BeautifulSoup(html, "html.parser")

        print("\nImportant Elements Found:\n")

        # Look for the main CAPTCHA container
        container = soup.find(class_="bitcapcha-container")
        if container:
            print("Found .bitcapcha-container")

            # Check for SVG elements
            svg = container.find("svg")
            if svg:
                print(" - Found embedded SVG for checkbox and label")

            # Check for status message area
            status = soup.find(id="status")
            if status:
                print(" - Found status display element")
        else:
            print(" - No .bitcapcha-container found")

        # Attempt to extract scripts (what a bot might try to analyze)
        scripts = soup.find_all("script")
        print(f"\nFound {len(scripts)} <script> tag(s)")
        for i, script in enumerate(scripts):
            if script.string:
                snippet = script.string.strip()[:200]
                print(f"\nScript {i + 1} Preview:\n{snippet}...\n")
            else:
                print(f"\nScript {i + 1} is external or empty")

    except requests.exceptions.RequestException as e:
        print(f"Request failed: {e}")

# Run it
scrape_captcha(url)
